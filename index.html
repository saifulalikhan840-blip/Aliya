<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For Junmoni ‚Äî A Little Code</title>
<style>
  :root{--bg:#0b1020;--panel:#0f1724;--accent:#ff6b9a;--muted:#9aa4b2}
  *{box-sizing:border-box}
  body{margin:0;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    background:radial-gradient(circle at 10% 10%, #091021 0%, var(--bg) 40%), linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
    color:#d7e3f0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{width:900px;max-width:100%;border-radius:16px;overflow:hidden;box-shadow:0 10px 40px rgba(2,6,23,0.7);display:grid;grid-template-columns:1fr 1fr}
  .terminal{background:linear-gradient(180deg,var(--panel), #071022);padding:28px 20px;min-height:420px}
  .title{display:flex;gap:10px;align-items:center;margin-bottom:12px}
  .dots{display:flex;gap:6px}.dot{width:12px;height:12px;border-radius:50%}.d1{background:#ff5f56}.d2{background:#ffbd2e}.d3{background:#27c93f}
  .code{background:#071021;padding:18px;border-radius:10px;color:#cde7ff;font-size:15px;line-height:1.5;min-height:300px;position:relative;overflow:hidden;white-space:pre-wrap;font-family:inherit}
  .cursor{display:inline-block;width:8px;background:var(--accent);margin-left:6px;animation:blink 1s infinite}
  @keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}
  .reveal{background:linear-gradient(180deg,#071226, #081124);padding:28px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;position:relative}
  .heart-bg{position:absolute;inset:0;pointer-events:none}.heart{position:absolute;opacity:0.08;font-size:80px;transform:translate(-50%,-50%) rotate(-20deg)}
  .name{font-size:28px;color:var(--accent);font-weight:700;margin:0}.msg{color:var(--muted);text-align:center;max-width:320px}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 16px;border-radius:10px;color:var(--accent);cursor:pointer}
  .floating-heart{position:absolute;bottom:-40px;font-size:20px;opacity:0.9;animation:floatUp linear infinite}
  @keyframes floatUp{0%{transform:translateY(0) scale(0.8);opacity:0}10%{opacity:1}100%{transform:translateY(-520px) scale(1.1);opacity:0}}
  @media (max-width:800px){.card{grid-template-columns:1fr}.reveal{padding:18px}.code{min-height:260px}}
</style>
</head>
<body>
  <div class="card" role="main">
    <div class="terminal">
      <div class="title">
        <div class="dots"><div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div></div>
        <div style="margin-left:auto;color:var(--muted);font-size:13px">project: crush.js</div>
      </div>

      <div id="codeArea" class="code" aria-live="polite"></div>
      <span id="cursor" class="cursor" aria-hidden="true"></span>
    </div>

    <div class="reveal">
      <div class="heart-bg" aria-hidden="true">
        <div class="heart" style="left:25%;top:10%;">‚ù§</div>
        <div class="heart" style="left:70%;top:30%;font-size:120px;opacity:0.06">‚ù§</div>
        <div class="heart" style="left:50%;top:70%;font-size:100px;opacity:0.05">‚ù§</div>
      </div>

      <h2 class="name">Hey Junmoni üëã</h2>
      <p class="msg">I started with a little code ‚Äî and somehow it led me here. Click the button to reveal something silly and sweet.</p>
      <div style="display:flex;gap:10px">
        <button id="revealBtn" class="btn">Reveal ‚Üí</button>
        <button id="copyBtn" class="btn" title="Copy a short note to send">Copy note</button>
      </div>
    </div>
  </div>

  <!-- working public audio source (Pixabay piano) -->
  <audio id="bgAudio" preload="none">
    <source src="https://cdn.pixabay.com/download/audio/2022/10/24/audio_cdfb7cbb1a.mp3" type="audio/mpeg" />
  </audio>

<script>
/* Robust typing + reveal + audio handling */
(() => {
  const lines = [
    "// initializing feelings...",
    "const crush = {",
    "  name: \"Junmoni\",",
    "  smile: () => \"sunrise()\",",
    "  laugh: () => \"melody()\",",
    "  effectOnMe: \"infinite\",",
    "};",
    "",
    "if (crush.name === \"Junmoni\") {",
    "  heart.rate += 20; // just a little",
    "  joy.level = 'too-high';",
    "}",
    "",
    "// run this when you're ready:",
    "function ask(outcome) {",
    "  return `Would you like to go out for coffee? ‚ù§Ô∏è`;",
    "}",
    "",
    "// ‚Äî end of playful code ‚Äî"
  ];

  const codeArea = document.getElementById('codeArea');
  const cursor = document.getElementById('cursor');
  const revealBtn = document.getElementById('revealBtn');
  const copyBtn = document.getElementById('copyBtn');
  const audio = document.getElementById('bgAudio');

  // typing effect
  let li = 0, ci = 0;
  const TYPE_SPEED = 28, LINE_DELAY = 450;
  function typeNextChar() {
    try {
      if (li >= lines.length) { cursor.style.display = 'none'; return; }
      const line = lines[li];
      if (ci < line.length) {
        codeArea.textContent += line[ci++];
        setTimeout(typeNextChar, TYPE_SPEED + Math.random()*8);
      } else {
        codeArea.textContent += '\n';
        li++; ci = 0;
        setTimeout(typeNextChar, LINE_DELAY);
      }
      codeArea.scrollTop = codeArea.scrollHeight;
    } catch (e) {
      console.error("Typing error:", e);
      cursor.style.display = 'none';
    }
  }
  setTimeout(typeNextChar, 600);

  // audio play with graceful error message
  let audioStarted = false;
  async function tryPlayAudio() {
    try {
      await audio.play();
      audioStarted = true;
      return true;
    } catch (err) {
      console.warn("Audio play failed:", err);
      return false;
    }
  }

  revealBtn.addEventListener('click', async () => {
    // show hearts animation
    for (let i=0;i<8;i++) setTimeout(createFloatingHeart, i*100);

    // reveal message
    const p = document.querySelector('.msg');
    p.innerText = "I think you‚Äôre brilliant, and I‚Äôd love to take you out for coffee sometime. No pressure ‚Äî just curious to know you better.";
    document.querySelector('.name').innerText = 'Junmoni, wanna grab coffee? ‚òïÔ∏è';
    revealBtn.disabled = true; revealBtn.innerText = 'Sent ‚ù§Ô∏è';

    // try to play audio if not started (optional)
    if (!audioStarted) {
      const ok = await tryPlayAudio();
      if (!ok) {
        // avoid alert spam ‚Äî show a subtle console instruction
        console.info("Audio couldn't start automatically. Try clicking Play in the browser controls or test the MP3 URL directly in a new tab.");
      }
    }

    // append small marker in code area
    codeArea.textContent += '\n// message prepared: readyToSend = true;';
    codeArea.scrollTop = codeArea.scrollHeight;
  });

  copyBtn.addEventListener('click', async () => {
    const note = "Hey Junmoni ‚Äî would you like to go for coffee sometime? I‚Äôd love to know you better. :)";
    try {
      await navigator.clipboard.writeText(note);
      copyBtn.innerText = 'Copied!';
      setTimeout(()=> copyBtn.innerText = 'Copy note', 1400);
    } catch (e) {
      console.error("Copy failed:", e);
      alert('Could not copy automatically ‚Äî select the text and copy manually.');
    }
  });

  function createFloatingHeart(){
    const heart = document.createElement('div');
    heart.className = 'floating-heart';
    heart.style.left = (20 + Math.random()*60) + '%';
    heart.style.fontSize = (12 + Math.random()*36) + 'px';
    heart.style.animationDuration = (3 + Math.random()*4) + 's';
    heart.style.opacity = 0.9;
    heart.innerText = '‚ù§';
    document.querySelector('.reveal').appendChild(heart);
    setTimeout(()=> heart.remove(), 7000);
  }

  // allow Enter key to reveal
  document.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') revealBtn.click(); });
})();
</script>
</body>
</html>
